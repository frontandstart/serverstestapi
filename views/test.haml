/** %Y-%m-%dT%H:%M:%S.%3N%Z - timeformat
!!!
%html
  %head
    %script{ :src => 'https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js' }
    %script{ :src => 'https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.0/d3.min.js' }
    %script{ :src => '/metricsgraphics.min.js' }
    %link{ :href => '/metricsgraphics.min.css', :rel => 'stylesheet', :type => 'text/css' }
  %body
    .chart
    :javascript
      var data = $.getJSON( "example.json", function(json) {

      });

      d3.json("/ips/#{@ip_id}/pings/?from=#{@time_from}&to=#{@time_to}", function(data) {
        data = MG.convert.date(data, 'created_at');
        MG.data_graphic({
            title: "Few Observations",
            description: "We sometimes have only a few observations. By setting missing_is_zero: true, missing values for a time-series will be interpreted as zeros. In this example, we've overridden the rollover callback to show 'no data' for missing observations and have set the min_x and max_x options in order to expand the date range.",
            data: data,
            interpolate: 'basic',
            missing_is_zero: true,
            width: 1200,
            height: 400,
            right: 40,
            target: '.chart',
            x_accessor: 'created_at',
            y_accessor: 'rtt',
            mouseover: function(d, i) {
                var df = d3.time.format('%Y-%m-%dT%H:%M:%S.000Z');
                var date = df(d.date);
                var y_val = (d.value === 0) ? 'no data' : d.value;

                d3.select('#missing-y svg .mg-active-datapoint')
                    .text(date +  '   ' + y_val);
            }
        });
      });